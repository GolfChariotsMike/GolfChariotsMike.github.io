<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSSIE INDOOR FIXTURES</title>
    <style>
        body {
    font-family: 'Roboto', sans-serif;
    background-color: #2a1e21; /* black background */
    color: #212529; /* Dark text */
    text-align: center;
}

h1 {
    font-size: 2.5em;
    color: #de2829; /* RED */
    margin-bottom: 20px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px auto; /* Center the table */
    background-color: white;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

th, td {
    border: 1px solid #dee2e6;
    padding: 16px;
    text-align: center;
}

th {
    background-color: #de2829; /* RED header */
    color: white;
    font-weight: bold;
    font-size: 1.8em;
}

td {
    background-color: #ffffff;
    font-size: 1.2em;
}

tr:nth-child(even) td {
    background-color: #f2f2f2; /* Light gray rows */
}

.match {
    font-size: 1.5em;
    line-height: 1.5;
}

.match span {
    display: block; /* Ensures each part (team names and 'vs') is on its own line */
}

.match .vs {
    font-size: 1.2em;
    font-weight: bold;
    color: #ff0000; /* Optional: Red for 'vs' */
}

    </style>
</head>
<body>
    <h1 id="title">OSSIE INDOOR BEACH VOLLEYBALL</h1>
    <div id="data">Loading data...</div>
    <script>
        async function fetchXML(url) {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const text = await response.text();
            const parser = new DOMParser();
            return parser.parseFromString(text, 'application/xml');
        }

        async function loadFixtures() {
    try {
        // Get today's date in the local timezone
        const now = new Date();
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate()); // Normalized to midnight

        const urls = {
            Monday: ['https://ossieindoorbeachvolleyball.spawtz.com/External/Fixtures/Feed.aspx?Type=Fixtures&LeagueId=2&SeasonId=4'],
            Tuesday: [
                'https://ossieindoorbeachvolleyball.spawtz.com/External/Fixtures/Feed.aspx?Type=Fixtures&LeagueId=3&SeasonId=4',
                'https://ossieindoorbeachvolleyball.spawtz.com/External/Fixtures/Feed.aspx?Type=Fixtures&LeagueId=9&SeasonId=4'
            ],
            // Add other days here...
        };

        const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const currentDay = daysOfWeek[today.getDay()];
        const selectedURLs = urls[currentDay];
        if (!selectedURLs || selectedURLs.length === 0) {
            document.getElementById('data').innerHTML = `No fixtures available for ${currentDay}.`;
            return;
        }

        // Fetch all XML data
        const allData = await Promise.all(selectedURLs.map(fetchXML));

        // Filter fixtures for today's date only
        const fixtureData = {};
        allData.forEach(xml => {
            const fixtures = xml.getElementsByTagName('Fixture');
            for (const fixture of fixtures) {
                const dateTimeString = fixture.getAttribute('DateTime');
                const [datePart] = dateTimeString.split(' '); // Extract date (DD/MM/YYYY)
                const [day, month, year] = datePart.split('/');
                const fixtureDate = new Date(`${year}-${month}-${day}`); // Convert to local date object

                // Compare fixture date with today's date
                if (fixtureDate.toDateString() === today.toDateString()) {
                    const timePart = dateTimeString.split(' ')[1];
                    const court = fixture.getAttribute('PlayingAreaName');
                    const match = {
                        homeTeam: fixture.getAttribute('HomeTeam'),
                        awayTeam: fixture.getAttribute('AwayTeam'),
                    };

                    if (!fixtureData[timePart]) {
                        fixtureData[timePart] = {};
                    }
                    fixtureData[timePart][court] = match;
                }
            }
        });

        if (Object.keys(fixtureData).length === 0) {
            document.getElementById('data').innerHTML = `No fixtures available for today (${today.toLocaleDateString()}).`;
            return;
        }

        // Display the day in the title
        document.getElementById('title').textContent += ` - ${currentDay} (${today.toLocaleDateString()})`;

        // Build the table
        let output = '<table><tr><th>Time</th>';
        const allCourts = Array.from(
            new Set(
                Object.values(fixtureData).flatMap(times => Object.keys(times))
            )
        );
        allCourts.forEach(court => {
            output += `<th>${court}</th>`;
        });
        output += '</tr>';

        Object.entries(fixtureData).forEach(([time, courts]) => {
            output += `<tr><td><strong>${time}</strong></td>`;
            allCourts.forEach(court => {
                if (courts[court]) {
                    const match = courts[court];
                    output += `<td class="match">
                        <span>${match.homeTeam}</span>
                        <span class="vs">vs</span>
                        <span>${match.awayTeam}</span>
                    </td>`;
                } else {
                    output += `<td></td>`;
                }
            });
            output += '</tr>';
        });

        output += '</table>';
        document.getElementById('data').innerHTML = output;
    } catch (err) {
        console.error('Error fetching or processing XML:', err);
        document.getElementById('data').innerHTML = 'Error loading data.';
    }
}
        loadFixtures();
    </script>
</body>
</html>
